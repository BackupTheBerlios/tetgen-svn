\chapter{Mesh Transformations}

Mesh transformation operations translate an old set of tetrahedra into a new set of tetrahedra in the same region of the tetrahedralization. Such operations include face/edge flips, vertex insertion/deletions.

\section{Point insertion}

This section discusses the implementation of inserting a vertex. The Bowyer-Watson algorithm~\cite{Bowyer81, Watson81} is used to implement this. It also handles the insertion of hull vertex, i.e., the convex hull will be updated.

\begin{figure}
  \centering
  \includegraphics[width=0.9\textwidth]{../figs/bowyerwatson1}
\caption{Insert a interior vertex. Here {\tt insertpt} lies inside the convex hull.}
\label{fig:bowyerwatson1}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{../figs/inserthullvertex}
\caption{Insert a hull vertex. Here {\tt insertpt} lies outside the convex hull. }
\label{fig:inserthullvertex}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=1.0\textwidth]{../figs/bowyerwatson2}
\caption{Insert a hull vertex. Here {\tt insertpt} lies outside the convex hull. {\tt cavetet} is a hull tet, and it points to a side face whose apex is the {\tt dummypoint}. A {\tt newtet} is created on the base face of {\tt cavetet}, it is a hull tet.}
\label{fig:bowyerwatson2}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=1.0\textwidth]{../figs/bowyerwatson3}
\caption{Insert a hull vertex. Here {\tt insertpt} lies outside the convex hull. {\tt cavetet} is a hull tet, and it points to its base face which is visible by {\tt insertp}. A {\tt newtet} is created on the base face of {\tt cavetet}, it is not a hull tet.}
\label{bowyerwatson3}
\end{figure}

\section{Primitive Flips}

Given $5$ vertices, denoted ${\bf a}$, ${\bf b}$, ${\bf c}$, ${\bf d}$, and ${\bf e}$, in convex position. There are two primitives flips on these $5$ vertices, which are:
\begin{itemize}
\item {\tt flip23}: transform $2$ tetrahedra to $3$ tetrahedra. As a result, an internal face has been removed and a new edge is inserted.
\item {\tt flip32}: the reverse of {\tt flip23}.
\end{itemize}

\begin{figure}
  \centering
  \includegraphics[width=0.5\textwidth]{../figs/flip-cosph5-2tets}
\caption{Flip operations: 2-to-3 and 3-to-2 flips.}
\label{fig:flip23}
\end{figure}


